(function(e){function t(t){for(var r,a,o=t[0],l=t[1],c=t[2],d=0,h=[];d<o.length;d++)a=o[d],Object.prototype.hasOwnProperty.call(s,a)&&s[a]&&h.push(s[a][0]),s[a]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);u&&u(t);while(h.length)h.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,o=1;o<n.length;o++){var l=n[o];0!==s[l]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},s={app:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("85ec"),s=n.n(r);s.a},"0d4d":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);var r=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("b-container",[n("b-row",[n("b-col",{attrs:{cols:"3"}},[n("ListeVentes",{attrs:{listeDesVentes:e.listeDesVentes},on:{changeDetailVente:e.changeDetailVente,creeNouvelleVente:e.creeNouvelleVente,rafraichitCatalogue:function(t){return e.$maisonDeVente.rafraichitCatalogue()},lanceUneRecherche:e.lanceUneRecherche}})],1),n("b-col",{attrs:{cols:"9"}},[e.resultatsRecherche.length?n("b-container",[n("b-row",e._l(e.resultatsRecherche,(function(t){return n("b-col",{key:"found_"+t.id,attrs:{cols:"4"}},[n("b-card",{attrs:{"no-body":""}},[n("b-card-header",{domProps:{innerHTML:e._s(t.content[0].html&&t.content[0].html.length?t.content[0].html:t.obj.title)}}),n("b-card-body",[n("p",{domProps:{innerHTML:e._s(t.content[1].html&&t.content[1].html.length?t.content[1].html:t.obj.description)}})]),n("b-list-group",{attrs:{flush:""}},[e._l(t.content,(function(t,r){return[r>1&&t.html&&t.html.length?n("b-list-group-item",{key:"vente_"+t.id,attrs:{href:"#",id:"vente_"+t.id},domProps:{innerHTML:e._s(t.html)}}):e._e()]}))],2)],1)],1)})),1)],1):e.selectionActive.vente?n("DetailVente",{attrs:{detailVente:e.selectionActive}}):e.nouvelleVente?n("NouvelleVente",{on:{enregistrerVente:e.enregistrerVente}}):n("span",[n("h1",[e._v("Bienvenue dans la maison de vente")]),n("p",[e._v("Veuillez selectionner une vente ")])])],1)],1)],1)],1)},i=[],a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("b-card",{attrs:{"no-body":"",header:"Liste des ventes"}},[n("b-list-group",{attrs:{flush:""}},[e._l(e.listeDesVentes,(function(t){return[n("b-list-group-item",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",modifiers:{hover:!0,right:!0}}],key:"vente_"+t.id,attrs:{href:"#",title:t.description,id:"vente_"+t.id},on:{click:function(n){return e.$emit("changeDetailVente",t)}}},[e._v(" "+e._s(t.title)+" ")])]}))],2),n("b-card-body",[n("b-input-group",{scopedSlots:e._u([{key:"prepend",fn:function(){return[n("b-input-group-text",{staticClass:"icon-sm"},[n("b-icon",{attrs:{icon:"search","aria-hidden":"true"}})],1)]},proxy:!0}])},[n("b-form-input",{on:{focus:function(t){return e.$emit("rafraichitCatalogue")},input:function(t){return e.$emit("lanceUneRecherche",t)}}})],1)],1)],1),n("b-button",{staticClass:"listeBtn",on:{click:function(t){return e.$emit("creeNouvelleVente")}}},[e._v(" Ajouter une vente ")])],1)},o=[],l={name:"ListeVentes",props:{listeDesVentes:Array}},c=l,u=(n("b9d9"),n("2877")),d=Object(u["a"])(c,a,o,!1,null,"3adc8495",null),h=d.exports,p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-card",{attrs:{header:e.detailVente.vente.title}},[n("p",{staticClass:"card-text mt-2"},[e._v(e._s(e.detailVente.vente.description))]),n("b-list-group",e._l(e.detailVente.lots,(function(t){return n("b-list-group-item",{key:"lot_"+t.id},[e._v(" "+e._s(t.description)+" ")])})),1)],1)},b=[],f={name:"detailVente",props:{detailVente:{type:Object,default:()=>{}}}},v=f,m=Object(u["a"])(v,p,b,!1,null,"f91ef3dc",null),g=m.exports,V=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-card",{attrs:{"bg-variant":"light"}},[n("b-form-group",{staticClass:"mb-2",attrs:{"label-cols-lg":"3",label:"Nouvelle vente","label-size":"lg","label-class":"font-weight-bold pt-0"}},[n("b-container",{attrs:{fluid:""}},[n("b-row",{staticClass:"mb-1"},[n("b-col",{attrs:{sm:"2"}},[n("label",{attrs:{for:"titre"}},[e._v("Titre:")])]),n("b-col",{attrs:{sm:"10"}},[n("b-form-input",{attrs:{id:"titre",placeholder:"Titre de la vente"},model:{value:e.vente.title,callback:function(t){e.$set(e.vente,"title",t)},expression:"vente.title"}})],1)],1),n("b-row",{staticClass:"mb-1"},[n("b-col",{attrs:{sm:"2"}},[n("label",{attrs:{for:"description"}},[e._v("Description:")])]),n("b-col",{attrs:{sm:"10"}},[n("b-form-textarea",{attrs:{id:"description",placeholder:"Description de la vente"},model:{value:e.vente.description,callback:function(t){e.$set(e.vente,"description",t)},expression:"vente.description"}})],1)],1)],1)],1),n("b-form-group",{staticClass:"mb-2",attrs:{"label-cols-lg":"3",label:"Lots","label-size":"lg","label-class":"font-weight-bold pt-0"}},[e._l(e.lots,(function(t,r){return n("b-container",{key:"lot_"+r,attrs:{fluid:""}},[n("b-row",{staticClass:"mb-1"},[n("b-col",{attrs:{sm:"2"}},[n("label",{attrs:{for:"description"}},[e._v("Description:")])]),n("b-col",{attrs:{sm:"10"}},[n("b-form-textarea",{attrs:{id:"description",placeholder:"Description du lot"},on:{inpit:e.$emit},model:{value:t.description,callback:function(n){e.$set(t,"description",n)},expression:"lot.description"}})],1)],1)],1)})),n("b-container",[n("b-button",{staticClass:"float-right",on:{click:e.ajoutLot}},[e._v("Ajouter un lot")])],1)],2),n("b-form-group",[n("b-button",{on:{click:function(t){return e.enregistrerVente({vente:e.vente,lots:e.lots})}}},[e._v("CrÃ©er la vente")])],1)],1)},_=[],y={name:"NouvelleVente",data:()=>({vente:{title:"",description:""},lots:[{description:""}]}),methods:{ajoutLot(){this.lots.push({description:""})},async enregistrerVente(e){await this.$emit("enregistrerVente",e)}}},j=y,w=Object(u["a"])(j,V,_,!1,null,"42ba6adb",null),D=w.exports,O={name:"App",components:{ListeVentes:h,DetailVente:g,NouvelleVente:D},data:()=>({selectionActive:{},nouvelleVente:!1,listeDesVentes:[],resultatsRecherche:[]}),methods:{creeNouvelleVente(){this.nouvelleVente=!0,this.selectionActive={},this.resultatsRecherche=[]},async changeDetailVente(e){this.resultatsRecherche=[],this.selectionActive={vente:e,lots:await this.$maisonDeVente.detailVente(e.id)}},async enregistrerVente(e){this.$maisonDeVente.nouvelleVente(e).then(async e=>{await this.chargeVentes(),await this.changeDetailVente(e)})},async chargeVentes(){this.listeDesVentes=await this.$maisonDeVente.listeDesVentes()},async lanceUneRecherche(e){this.resultatsRecherche=e.length>2?this.$maisonDeVente.lanceUneRecherche(e):[],console.log(this.resultatsRecherche)}},mounted(){this.chargeVentes()}},$=O,k=(n("034f"),Object(u["a"])($,s,i,!1,null,null,null)),x=k.exports,C=(n("ddb0"),n("ade3")),R=n("cee4"),N=n("bbd6"),P=n.n(N);const L="http://localhost:3000/",A={"content-type":"application/json"};var S=class{constructor(){Object(C["a"])(this,"listeDesVentes",async()=>await R["a"].get(L+"sales").then(e=>e.data)),Object(C["a"])(this,"detailVente",async e=>await R["a"].get(L+"items?sale_id="+e).then(e=>e.data)),Object(C["a"])(this,"nouvelleVente",async({vente:e,lots:t})=>await R["a"].post(L+"sales",JSON.stringify(e),{headers:A}).then(async({data:e})=>(await Promise.all(t.map(t=>{const n=JSON.stringify({...t,sale_id:e.id});return R["a"].post(L+"items",n,{headers:A})})),e))),Object(C["a"])(this,"rafraichitCatalogue",()=>{R["a"].get(L+"db").then(e=>{this.catalogue={objets:e.data.sales.map(t=>{const n=e.data.items.filter(e=>e.sale_id===t.id),r=n.reduce((e,t)=>({...e,["item_"+t.id]:t.description}),{});return{...t,...r}}),keys:e.data.items.map(e=>"item_"+e.id)}})}),Object(C["a"])(this,"lanceUneRecherche",e=>{const t={limit:100,threshold:-1e4,keys:["title","description",...this.catalogue.keys]},n=P.a.go(e,this.catalogue.objets,t).map(e=>({obj:e.obj,content:e.map(e=>({objet:e,html:P.a.highlight(e,"<b>","</b>")}))}));return console.log(this.catalogue),n})}},T=n("5f5b"),M=n("b1e0"),U=n("0759");n("f9e3"),n("2dd8");r["default"].prototype.$maisonDeVente=new S,r["default"].config.productionTip=!1,r["default"].use(T["a"]),r["default"].use(M["a"]),r["default"].component("BIcon",U["a"]),new r["default"]({render:e=>e(x)}).$mount("#app")},"85ec":function(e,t,n){},b9d9:function(e,t,n){"use strict";var r=n("0d4d"),s=n.n(r);s.a}});
//# sourceMappingURL=app.900ff2e7.js.map